<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thoughtWorks.dao.ModuleOneDao">
    <!--<insert id="addRolePermissions">-->
    <!--INSERT INTO t_role_permission (sys_role_id, sys_permission_id) VALUES-->
    <!--<foreach collection="shouldInsert" item="perId" separator="," close=";">-->
    <!--(#{roleId},#{perId})-->
    <!--</foreach>-->
    <!--</insert>-->

    <select id="findTestpaperClasses" parameterType="String" resultType="map">
         SELECT otc.classes_id,student.id StudentId,classes.name ClassesName
         FROM o_student student
            LEFT OUTER JOIN
                  (select * from o_student_classes) otc ON otc.student_id = student.id
            LEFT OUTER JOIN
                  (select * from o_classes) classes ON classes.id = otc.classes_id
         WHERE student.no = #{userName}
    </select>
    <select id="findTestpaper" parameterType="String" resultType="map">
        SELECT o_testpaper.*,o_classes.name ClassName,o_student_testpaper.*,o_student.*
        FROM o_testpaper,o_classes,o_student_testpaper,oj.o_student
        WHERE o_testpaper.classes_id=o_classes.id
        AND o_student.no = #{userName}
        AND o_testpaper.id=o_student_testpaper.testpaper_id
        AND o_student_testpaper.student_id=o_student.id
    </select>
    <select id="selectTestpaperById" resultType="Testpaper" parameterType="int">
        SELECT *
        FROM o_testpaper WHERE id=#{id}
    </select>

    <select id="selectSubjectfromid" resultType="map">
        SELECT * from oj.o_subject where id in
        <foreach item="item" index="index" collection="list"
                 open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <update id="updateScore" parameterType="com.thoughtWorks.entity.StudentTestpaper">
        UPDATE o_student_testpaper
        SET testpaper_student_score = #{testpaperStudentScore}
        WHERE oj.o_student_testpaper.testpaper_id = #{id}
    </update>
</mapper>